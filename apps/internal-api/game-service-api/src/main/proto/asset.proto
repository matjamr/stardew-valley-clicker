syntax = "proto3";

option java_multiple_files = true;
option java_package = "com.mat.jamr.gameservice.api";
option java_outer_classname = "AssetGrpcService";

service AssetService {
  rpc Create (CreateAssetRequest) returns (CreateAssetResponse) {}
  rpc Read (ReadAssetRequest) returns (ReadAssetResponse) {}
  rpc ReadMany (ReadManyAssetsRequest) returns (ReadManyAssetsResponse) {}
  rpc Delete (DeleteAssetRequest) returns (DeleteAssetResponse) {}
  rpc Update (UpdateAssetRequest) returns (UpdateAssetResponse) {}
}

message CreateAssetRequest {
  AssetType type = 1;
  string name = 2;
  string description = 3;
  bytes content = 4;
}

message CreateAssetResponse {
  Asset asset = 1;
}

message ReadAssetRequest {
  string id = 1;
}

message ReadAssetResponse {
  Asset asset = 1;
}

message ReadManyAssetsRequest {
  repeated string ids = 1;
}

message ReadManyAssetsResponse {
  repeated Asset assets = 1;
}

message DeleteAssetRequest {
  string id = 1;
}

message DeleteAssetResponse {
  bool success = 1;
}

message UpdateAssetRequest {
  Asset asset = 1;
}

message UpdateAssetResponse {
  Asset asset = 1;
}

enum AssetType {
  UNKNOWN = 0;
  IMAGE = 1;
  AUDIO = 2;
  VIDEO = 3;
  MODEL = 4;
  BUILDING = 5;
  WOOD = 6;
  STONE = 7;
  HARDWOOD = 8;
  HARDSTONE = 9;
  GROUND = 10;
  DECORATION = 11;
}

enum ActionType {
  VOID = 0;
  START_TIMER = 1;
  END_TIMER = 2;
  COLLECT_REWARD = 3;
  SPEED_UP = 4;
  FINISH_NOW = 5;
}

message TimerInfo {
  int64 duration_seconds = 1;
  string timer_id = 2;
}

message RewardInfo {
  repeated ResourceReward resources = 1;
  int32 xp_grant = 2;
}

message ResourceReward {
  string resource_id = 1;
  int32 amount = 2;
}

message EnergyInfo {
  int32 energy_consumption = 1;
}

message OnClickAction {
  ActionType action_type = 1;

  oneof action_data {
    TimerInfo timer_info = 2;
    RewardInfo reward_info = 3;
    EnergyInfo energy_info = 4;
  }
}


message Asset {
  AssetType type = 1;
  string id = 3;
  string name = 4;
  string description = 5;
  bytes content = 6;
  string url = 7;
  OnClickAction on_click_action = 8;
}